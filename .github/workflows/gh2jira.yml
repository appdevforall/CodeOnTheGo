name: Create Jira Ticket on New Issue

on:
  # This workflow runs whenever a new issue is opened.
  issues:
    types: [opened]

jobs:
  create_jira_ticket:
    # Use the latest stable Ubuntu runner environment.
    runs-on: ubuntu-latest
    
    # We use a third-party action, so we must first authenticate to Jira.
    steps:
      - name: Login to Jira
        # Use Atlassian's official login action
        uses: atlassian/gajira-login@v3 
        with:
          # Your Jira Base URL (e.g., https://your-company.atlassian.net)
          baseUrl: 'https://appdevforall.atlassian.net' 
          
          # The Jira user email associated with the API token
          user: 'haleisen@appdevforall.org' # e.g., bot-user@company.com
          
          # The JIRA API token secret you've set in your GitHub repository.
          # The JIRA_API_TOKEN is created in Jira user settings.
          token: ${{ secrets.JIRA_API_TOKEN }} 

      - name: Create Jira Issue
        # Use Atlassian's official create issue action
        uses: atlassian/gajira-create@v3 
        with:
          # The key for your target Jira project (e.g., 'PROJ', 'DEV').
          project: 'ADFA' 
          
          # The type of Jira issue to create (e.g., 'Task', 'Story', 'Bug').
          issuetype: 'Story' 
          
          # Sets the summary of the Jira ticket to the GitHub Issue title.
          summary: 'GitHub Issue: ${{ github.event.issue.title }}'
          
          # Sets the description of the Jira ticket. 
          # Includes the body of the GitHub issue and a link back to it.
          description: |
            *GitHub Issue:* #${{ github.event.issue.number }}
            *URL:* ${{ github.event.issue.html_url }}
            
            ---
            
            ${{ github.event.issue.body }}
